/*! session 2015-02-18 */
ReactiveStore=function(){"use strict";function a(a){var b=[],c={fn:a,flush:function(){_.some(b,_fn.dot("invalid"))&&c.run({})},addDependency:function(a){-1===b.indexOf(a)&&b.push(a)},run:function(d){b=[];var f=e;e=c,a(d),e=f}};return c}function b(){var b={changed:function(){b.invalid=!0,a.flush()},depend:function(){e&&e.addDependency(b)}};return b}function c(a,b){var c=_.filter(_.keys(g),function(b){return b===a||0===b.indexOf(a+".")});return 0===c.length?g[a]={value:b,deps:[]}:1===c.length&&c[0]===a?g[a]:(g[a]=g[a]||{value:void 0,deps:[]},_.reduce(c,function(b,c){var d=c.replace(a+".",""),e=g[c].value;return void 0!==e&&_fn.setProp(d,b.value,e),b},{value:{},deps:g[a].deps}))}function d(a){for(var b=[];a.length;)g[a]&&(b=b.concat(g[a].deps),g[a].deps=[]),a=-1!==a.indexOf(".")?a.replace(/\.[^\.]*$/,""):"";_.each(b,function(a){a.changed()})}var e,f,g={},h=[];a.flush=function(){_fn.fmap(_fn.exec("flush"),h)};var i={set:function(a,b){function e(){_.each(b,function(b,c){i.set(a+"."+c,b)})}function g(){var e=c(a);e.value!==b&&(e.value=b,d(a))}f&&console.log("set("+a+", "+b+")"),_.isPlainObject(b)?e():g()},get:function(a){f&&console.log("get("+a+")");var d=c(a),e=b();return e.depend(),d.deps.push(e),d.value},dump:function(){return _.reduce(_.keys(g),function(a,b){return a[b]=g[b].value,a},{})},autorun:function(b){var c=_.find(h,{fn:b});c?c.run({}):(c=a(b),c.run({firstRun:!0}),h.push(c))},nonReactive:function(a){var b=e;e=void 0,a(),e=b},debug:{on:function(){f=!0},off:function(){f=!1}}};return i};