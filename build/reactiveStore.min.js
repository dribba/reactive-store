/*! session 2015-02-16 */
ReactiveStore=function(){"use strict";function a(a){var b=[],c={fn:a,flush:function(){_.some(b,_fn.dot("invalid"))&&c.run({})},addDependency:function(a){-1===b.indexOf(a)&&b.push(a)},run:function(d){b=[];var f=e;e=c,a(d),e=f}};return c}function b(){var b={changed:function(){b.invalid=!0,a.flush()},depend:function(){e&&e.addDependency(b)}};return b}function c(a,b){var c=_.filter(_.keys(f),function(b){return b===a||0===b.indexOf(a+".")});return 0===c.length?f[a]={value:b,deps:[]}:1===c.length&&c[0]===a?f[a]:(f[a]=f[a]||{value:void 0,deps:[]},_.reduce(c,function(b,c){var d=c.replace(a+".",""),e=f[c].value;return void 0!==e&&_fn.setProp(d,b.value,e),b},{value:{},deps:f[a].deps}))}function d(a){for(var b=[];a.length;)f[a]&&(b=b.concat(f[a].deps),f[a].deps=[]),a=-1!==a.indexOf(".")?a.replace(/\.[^\.]*$/,""):"";_.each(b,function(a){a.changed()})}var e,f={},g=[];return a.flush=function(){_fn.fmap(_fn.exec("flush"),g)},{set:function(a,b){var e=c(a);e.value!==b&&(e.value=b,d(a))},get:function(a){var d=c(a),e=b();return e.depend(),d.deps.push(e),d.value},dump:function(){return _.reduce(_.keys(f),function(a,b){return a[b]=f[b].value,a},{})},autorun:function(b){var c=_.find(g,{fn:b});c?c.run({}):(c=a(b),c.run({firstRun:!0}),g.push(c))}}};