<html>
<head>
    <script src="../dist/reactive-store-for-browser.js"></script>
    <script>
        RS = ReactiveStore();
    </script>
</head>
<body>
    <h1>Performance test</h1>
<script>
    time(addItems.bind(null, 100));
    time(addObject.bind(null, 100));
    time(addItems.bind(null, 10000));

    time(function() {
        RS.set('another key1', 'some value');
        return 'add another key';
    });

    time(function() {
        RS.get('another key1');
        return 'get another key';
    });

    time(addObject.bind(null, 10));
    time(addObject.bind(null, 100));

    function uniq() {
        uniq.count = uniq.count || 0;
        return uniq.count++;
    }

    function addItems(num) {
        var unique = uniq();
        for(var i = num; i--;) {
            RS.set('aKey'+unique+i, 'some value');
        }
        return 'add '+num+' items';
    }

    function time(fn) {
        var start = new Date().getTime();
        console.log(fn(), new Date().getTime() - start);
    }

    function addObject(numOfKeys) {
        var obj = {};
        for(var i = numOfKeys; i--;) {
            obj['key'+i] = 'some value';
        }
        RS.set('object', obj);
        return 'add large object with '+numOfKeys+' keys';
    }

</script>
</body>
</html>